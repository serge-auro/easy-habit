
# Документация к коду Telegram бота для управления привычками

## Методы

### `create_inline_keyboard(button_keys)`
Создает и возвращает объект inline клавиатуры (`InlineKeyboardMarkup`) для использования в интерфейсе бота. 

**Параметры:**
- `button_keys` (`list`): Список ключей кнопок, которые должны быть добавлены на клавиатуру.

**Возвращает:**
- `InlineKeyboardMarkup`: Объект клавиатуры, содержащий кнопки, указанные в `button_keys`.

**Используемые типы и методы:**
- Использует глобальный словарь `buttons_dict` для получения названий кнопок.
- Использует `InlineKeyboardButton` для создания кнопок.
- Использует `InlineKeyboardMarkup` для создания и возврата клавиатуры.

### Обработчики callback запросов
Telegram бот использует декораторы `callback_query_handler` для обработки запросов от inline кнопок.

#### `handle_menu(call)`
Обрабатывает запросы на возвращение в главное меню.

**Параметры:**
- `call` (`telebot.types.CallbackQuery`): Данные запроса от пользователя.

**Процесс:**
- Создает клавиатуру с помощью `create_inline_keyboard`.
- Отправляет сообщение пользователю с помощью `bot.send_message`.

### `handle_status(call)`
Обрабатывает запросы на показ текущего статуса привычек пользователя.

**Параметры:**
- `call` (`telebot.types.CallbackQuery`): Данные запроса от пользователя.

**Процесс:**
- Получает статус привычек с помощью `habit_status`.
- Создает клавиатуру с помощью `create_inline_keyboard`.
- Отправляет сообщение пользователю с помощью `bot.send_message`.

### `handle_report(call)`
Обрабатывает запросы на получение отчетов о привычках пользователя.

**Параметры:**
- `call` (`telebot.types.CallbackQuery`): Данные запроса от пользователя.

**Процесс:**
- Получает отчет с помощью `report`.
- Создает клавиатуру с помощью `create_inline_keyboard`.
- Отправляет сообщение пользователю с помощью `bot.send_message`.

### `handle_edit_habit(call)`
Обрабатывает запросы на редактирование привычки пользователя.

**Параметры:**
- `call` (`telebot.types.CallbackQuery`): Данные запроса от пользователя.

**Процесс:**
- Получает статус привычек с помощью `habit_status`.
- Если привычки отсутствуют, информирует пользователя и завершает процесс.
- В противном случае, создает клавиатуру для каждой привычки для выбора редактирования.
- Отправляет сообщение пользователю с помощью `bot.send_message`.

**Продолжение следует...**

### `edit_selected_habit_frequency(call)`
Обрабатывает запросы на выбор периодичности для привычки.

**Параметры:**
- `call` (`telebot.types.CallbackQuery`): Данные запроса от пользователя.

**Процесс:**
- Извлекает выбранную привычку из данных запроса.
- Создает клавиатуру с выбором периодичности (ежедневно, еженедельно, ежемесячно).
- Отправляет сообщение пользователю с помощью `bot.send_message` для выбора периодичности.

### `request_habit_repetition_input(call)`
Обрабатывает запросы на ввод количества повторений для привычки.

**Параметры:**
- `call` (`telebot.types.CallbackQuery`): Данные запроса от пользователя.

**Процесс:**
- Разбирает данные запроса для определения привычки и выбранной периодичности.
- Запрашивает ввод количества повторений у пользователя, используя `bot.send_message` и `types.ForceReply` для активации ответа.

### `handle_repetition_count_input(message)`
Обрабатывает введенное пользователем количество повторений.

**Параметры:**
- `message` (`telebot.types.Message`): Сообщение от пользователя.

**Процесс:**
- Проверяет корректность введенного значения.
- Если значение корректно, обновляет информацию о привычке с помощью `update_habit`.
- В противном случае запрашивает повторный ввод.

### `handle_new_habit(call)`
Обрабатывает запросы на добавление новой привычки.

**Параметры:**
- `call` (`telebot.types.CallbackQuery`): Данные запроса от пользователя.

**Процесс:**
- Отправляет сообщение с клавиатурой для добавления новой привычки.

### `handle_del_habit(call)`
Обрабатывает запросы на удаление привычки.

**Параметры:**
- `call` (`telebot.types.CallbackQuery`): Данные запроса от пользователя.

**Процесс:**
- Получает статус всех привычек пользователя.
- Создает клавиатуру для каждой привычки, предлагая кнопки для их удаления.
- Отправляет сообщение пользователю с помощью `bot.send_message` для выбора привычки к удалению.

### `delete_selected_habit(call)`
Удаляет выбранную пользователем привычку.

**Параметры:**
- `call` (`telebot.types.CallbackQuery`): Данные запроса от пользователя.

**Процесс:**
- Извлекает выбранную привычку из данных запроса.
- Удаляет привычку с помощью `delete_habit`.
- Отправляет сообщение пользователю о успешном удалении.

### `handle_mark_habit(call)`
Обрабатывает запросы на отметку выполнения привычки.

**Параметры:**
- `call` (`telebot.types.CallbackQuery`): Данные запроса от пользователя.

**Процесс:**
- Получает статус всех привычек пользователя.
- Создает клавиатуру для каждой привычки, предлагая кнопки для их отметки.
- Отправляет сообщение пользователю с помощью `bot.send_message` для выбора привычки к отметке.

### `mark_selected_habit(call)`
Обрабатывает запросы на отметку выбранной привычки как выполненной.

**Параметры:**
- `call` (`telebot.types.CallbackQuery`): Данные запроса от пользователя.

**Процесс:**
- Извлекает выбранную привычку из данных запроса.
- Отмечает привычку как выполненную с помощью `mark_habit`.
- Отправляет подтверждение пользователю о успешной отметке привычки.

### `handle_habits(call)`
Показывает список всех привычек пользователя.

**Параметры:**
- `call` (`telebot.types.CallbackQuery`): Данные запроса от пользователя.

**Процесс:**
- Получает список всех привычек с помощью `list_habits`.
- Отправляет сообщение пользователю с перечнем всех его привычек.

### Обработчики команд
Telegram бот использует команды для управления основными функциями.

#### `handle_start(message)`
Обработчик для команды `/start`, которая инициализирует пользователя в системе и показывает начальное сообщение.

**Параметры:**
- `message` (`telebot.types.Message`): Сообщение от пользователя.

**Процесс:**
- Инициализирует пользователя с помощью `init_user`.
- Создает клавиатуру с помощью `create_inline_keyboard`.
- Отправляет приветственное сообщение пользователю.

#### `handle_help(message)`
Обработчик для команды `/help`, показывающей доступные команды и их описание.

**Параметры:**
- `message` (`telebot.types.Message`): Сообщение от пользователя.

**Процесс:**
- Создает клавиатуру с помощью `create_inline_keyboard`.
- Отправляет сообщение с описанием доступных команд.

## Завершение работы
`bot.polling(none_stop=True)`
- Запускает бота в режиме непрерывной обработки сообщений, позволяя ему оставаться активным и отвечать на запросы в реальном времени.
